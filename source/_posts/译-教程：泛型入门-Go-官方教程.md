---
title: (è¯‘) æ•™ç¨‹ï¼šæ³›å‹å…¥é—¨ (Go å®˜æ–¹æ•™ç¨‹)
abbrlink: e82052d2
date: 2022-04-12 22:15:16
updated: 2022-04-12 22:15:16
tags:
---
## è¯‘è€…åº

æœ¬æ–‡ç¿»è¯‘è‡ª **Golang** å®˜æ–¹æ•™ç¨‹ [**Tutorial: Getting started with generics**](https://go.dev/doc/tutorial/generics)ã€‚ä¸»è¦æ˜¯å…³äº **Golang** æ³›å‹çš„ç®€å•æ•™ç¨‹ã€‚
**ç”±äºè¯‘è€…æ°´å¹³æœ‰é™ï¼Œæœ¬æ–‡ä¸å…å­˜åœ¨é—æ¼æˆ–é”™è¯¯ä¹‹å¤„ã€‚å¦‚æœ‰ç–‘é—®ï¼Œè¯·æŸ¥é˜…åŸæ–‡ã€‚**
ä»¥ä¸‹æ˜¯è¯‘æ–‡ã€‚
<!-- more -->

---


æœ¬æ•™ç¨‹ä»‹ç» **Go** ä¸­æ³›å‹çš„åŸºç¡€çŸ¥è¯†ã€‚é€šè¿‡æ³›å‹ï¼Œä½ å¯ä»¥å£°æ˜å’Œä½¿ç”¨ç¼–å†™ä¸ºä¸è°ƒç”¨ä»£ç æä¾›çš„ä»»ä½•ä¸€ç»„ç±»å‹ä¸€èµ·ä½¿ç”¨çš„å‡½æ•°æˆ–ç±»å‹ã€‚
åœ¨æœ¬æ•™ç¨‹ä¸­ï¼Œä½ å°†å£°æ˜ä¸¤ä¸ªç®€å•çš„éæ³›å‹å‡½æ•°ï¼Œç„¶ååœ¨å•ä¸ªæ³›å‹å‡½æ•°ä¸­å®ç°ç›¸åŒçš„é€»è¾‘ã€‚
ä½ å°†é€æ­¥å®Œæˆä»¥ä¸‹éƒ¨åˆ†ï¼š

1. ä¸ºæ‚¨çš„ä»£ç åˆ›å»ºä¸€ä¸ªæ–‡ä»¶å¤¹ğŸ“ã€‚
2. æ·»åŠ éæ³›å‹ï¼ˆ**non-generic**ï¼‰å‡½æ•°ã€‚
3. æ·»åŠ ä¸€ä¸ªæ³›å‹å‡½æ•°æ¥å¤„ç†å¤šç§ç±»å‹ã€‚
4. è°ƒç”¨æ³›å‹å‡½æ•°æ—¶åˆ é™¤ç±»å‹å‚æ•°ï¼ˆ**type arguments**ï¼‰ã€‚
5. å£°æ˜ç±»å‹çº¦æŸï¼ˆ**Declare a type constraint**ï¼‰ã€‚


{% note info %}
æ³¨æ„ï¼šæœ‰å…³å…¶ä»–æ•™ç¨‹ï¼Œè¯·å‚é˜…[æ•™ç¨‹](https://go.dev/doc/tutorial/)ã€‚
æ³¨æ„ï¼šå¦‚æœæ‚¨æ„¿æ„ï¼Œå¯ä»¥ä½¿ç”¨[â€œGo dev åˆ†æ”¯â€æ¨¡å¼ä¸‹çš„ Go Playground](https://go.dev/play/?v=gotip)æ¥ç¼–è¾‘å’Œè¿è¡Œæ‚¨çš„ç¨‹åºã€‚
{% endnote %}


## å…ˆå†³æ¡ä»¶

- **Go 1.18** æˆ–æ›´é«˜ç‰ˆæœ¬çš„å®‰è£…ã€‚æœ‰å…³å®‰è£…è¯´æ˜ï¼Œè¯·å‚é˜…[å®‰è£…**Go**](https://go.dev/doc/install)ã€‚
- ç¼–è¾‘ä»£ç çš„å·¥å…·ã€‚ä»»ä½•æ–‡æœ¬ç¼–è¾‘å™¨éƒ½å¯ä»¥æ­£å¸¸å·¥ä½œã€‚
- ä¸€ä¸ªå‘½ä»¤ç»ˆç«¯ã€‚**Go** åœ¨ **Linux** å’Œ **Mac** ä¸Šçš„ä»»ä½•ç»ˆç«¯ä»¥åŠ **Windows** ä¸­çš„ **PowerShell** æˆ– **cmd** ä¸Šéƒ½èƒ½å¾ˆå¥½åœ°å·¥ä½œã€‚

## ä¸ºä½ çš„ä»£ç åˆ›å»ºä¸€ä¸ªæ–‡ä»¶å¤¹ğŸ“

é¦–å…ˆï¼Œä¸ºä½ è¦ç¼–å†™çš„ä»£ç åˆ›å»ºä¸€ä¸ªæ–‡ä»¶å¤¹ã€‚

1. æ‰“å¼€å‘½ä»¤æç¤ºç¬¦å¹¶åˆ‡æ¢åˆ°ä½ çš„ä¸»ç›®å½•ã€‚

    - Linux or Macï¼š

      ```Bash
      $ cd
      ```

    - Windowsï¼š

      ```PowerShell
      C:\> cd %HOMEPATH%
      ```

   æœ¬æ•™ç¨‹çš„å…¶ä½™éƒ¨åˆ†å°†æ˜¾ç¤º `$` ä½œä¸ºæç¤ºç¬¦ã€‚ä½ ä½¿ç”¨çš„å‘½ä»¤ä¹Ÿå¯ä»¥åœ¨ **Windows** ä¸Šè¿è¡Œã€‚

2. åœ¨å‘½ä»¤æç¤ºç¬¦ä¸‹ï¼Œä¸ºä½ çš„ä»£ç åˆ›å»ºä¸€ä¸ªåä¸º **generics** çš„ç›®å½•ã€‚

   ```Bash
   $ mkdir generics
   $ cd generics
   ```

3. åˆ›å»ºä¸€ä¸ªæ¨¡å—æ¥ä¿å­˜æ‚¨çš„ä»£ç ã€‚
   è¿è¡Œ` go mod init `å‘½ä»¤ï¼Œä¸ºå…¶æä¾›æ–°ä»£ç çš„æ¨¡å—è·¯å¾„ã€‚

   ```Bash
   $ go mod init example/generics
   go: creating new go.mod: module example/generics
   
   ```

   > å¯¹äºç”Ÿäº§ä»£ç ï¼Œä½ éœ€è¦æŒ‡å®šä¸€ä¸ªæ›´ç¬¦åˆæ‚¨è‡ªå·±éœ€æ±‚çš„æ¨¡å—è·¯å¾„ã€‚æœ‰å…³æ›´å¤šä¿¡æ¯ï¼Œè¯·åŠ¡å¿…æŸ¥çœ‹ [Managing dependencies](https://go.dev/doc/modules/managing-dependencies)ã€‚

æ¥ä¸‹æ¥ï¼Œä½ å°†æ·»åŠ ä¸€äº›ç®€å•çš„ä»£ç æ¥å¤„ç† **map**ã€‚

## æ·»åŠ éæ³›å‹å‡½æ•°

åœ¨è¿™ä¸€æ­¥ä¸­ï¼Œä½ å°†æ·»åŠ ä¸¤ä¸ªå‡½æ•°ï¼Œæ¯ä¸ªå‡½æ•°å°† **map** ä¸­çš„å€¼ç›¸åŠ å¹¶è¿”å›æ€»æ•°ã€‚

ä½ éœ€è¦å£°æ˜ä¸¤ä¸ªå‡½æ•°è€Œä¸æ˜¯ä¸€ä¸ªï¼Œå› ä¸ºä½ è¦å¤„ç†ä¸¤ç§ä¸åŒç±»å‹çš„ **map** ï¼šä¸€ç§å­˜å‚¨ **int64** ç±»å‹çš„å€¼ï¼Œå¦ä¸€ç§å­˜å‚¨ **float64** ç±»å‹çš„å€¼ã€‚

### ç¼–å†™ä»£ç 

1. ä½¿ç”¨æ‚¨çš„æ–‡æœ¬ç¼–è¾‘å™¨ï¼Œåœ¨ **generics** ç›®å½•ä¸­åˆ›å»ºä¸€ä¸ªåä¸º `main.go `çš„æ–‡ä»¶ã€‚ä½ å°†åœ¨è¿™ä¸ªæ–‡ä»¶ä¸­ç¼–å†™ä½ çš„ **Go** ä»£ç ã€‚

2. è¿›å…¥ `main.go`ï¼Œåœ¨æ–‡ä»¶é¡¶éƒ¨ï¼Œå†™å…¥ä»¥ä¸‹åŒ…å£°æ˜ã€‚

   ```Go
   package main
   ```

   ä¸€ä¸ªç‹¬ç«‹ç¨‹åºï¼ˆä¸åº“ç›¸åï¼‰å§‹ç»ˆä½äº `main` åŒ…ä¸­ã€‚

3. åœ¨åŒ…å£°æ˜ä¸‹æ–¹ï¼Œå†™å…¥ä»¥ä¸‹ä¸¤ä¸ªå‡½æ•°å£°æ˜ã€‚

   ```Go
   // SumInts adds together the values of m.
   func SumInts(m map[string]int64) int64 {
       var s int64
       for _, v := range m {
           s += v
       }
       return s
   }
   
   // SumFloats adds together the values of m.
   func SumFloats(m map[string]float64) float64 {
       var s float64
       for _, v := range m {
           s += v
       }
       return s
   }
   
   ```

   åœ¨ä»£ç ä¸­ï¼š

    - å£°æ˜ä¸¤ä¸ªå‡½æ•°æ¥å°† Map ä¸­çš„çš„å€¼ç›¸åŠ å¹¶è¿”å›æ€»æ•°
        - `SumInts` é’ˆå¯¹ **string â†’ int64** ç±»å‹çš„ **map**
        - `SumFloats` é’ˆå¯¹ **string â†’ floats** ç±»å‹çš„ **map**

4. åœ¨ `main.go` é¡¶éƒ¨çš„åŒ…å£°æ˜ä¸‹æ–¹ï¼Œç²˜è´´ä»¥ä¸‹çš„ `main` å‡½æ•°æ¥åˆå§‹åŒ–ä¸¤ä¸ª**map**ï¼Œå¹¶ä¸”ç”¨ä½œå‚æ•°æ¥è°ƒç”¨åœ¨ä¸Šä¸€æ­¥ä¸­å£°æ˜çš„å‡½æ•°ã€‚

   ```Go
   func main() {
       // Initialize a map for the integer values
       ints := map[string]int64{
           "first":  34,
           "second": 12,
       }
   
       // Initialize a map for the float values
       floats := map[string]float64{
           "first":  35.98,
           "second": 26.99,
       }
   
       fmt.Printf("Non-Generic Sums: %v and %v\n",
           SumInts(ints),
           SumFloats(floats))
   }
   ```

   åœ¨ä»£ç ä¸­ï¼š

    - åˆå§‹åŒ–äº†ä¸€ä¸ª **value** ä¸º **int64** ç±»å‹çš„ **map** å’Œä¸€ä¸ª **value** ä¸º **float64** ç±»å‹çš„ **map**ï¼Œæ¯ä¸ª **map** ä¸­æœ‰ä¸¤æ¡æ•°æ®
    - è°ƒç”¨ä½ ä¹‹å‰å®šä¹‰çš„ä¸¤ä¸ªå‡½æ•°æ¥è®¡ç®—æ¯ä¸ª **map** çš„æ‰€æœ‰å€¼çš„æ€»å’Œã€‚
    - æ‰“å°ç»“æœ

5. åœ¨ `main.go` é¡¶éƒ¨é™„è¿‘ï¼Œå°±åœ¨åŒ…å£°æ˜çš„ä¸‹æ–¹ï¼Œå¯¼å…¥æ‚¨éœ€è¦æ”¯æŒä½ åˆšåˆšç¼–å†™çš„ä»£ç çš„åŒ…ã€‚ ç¬¬ä¸€è¡Œä»£ç åº”å¦‚ä¸‹æ‰€ç¤ºï¼š

   ```Go
   package main
   
   import "fmt"
   ```

6. ä¿å­˜ `main.go`



### è¿è¡Œä»£ç 

åœ¨ `main.go` çš„ç›®å½•ä¸­çš„å‘½ä»¤è¡Œä¸­ï¼Œè¿è¡Œä»£ç ã€‚

```Bash
$ go run .
Non-Generic Sums: 46 and 62.97
```


é€šè¿‡æ³›å‹ï¼Œå¯ä»¥åªç¼–å†™ä¸€ä¸ªå‡½æ•°æ¥æ›¿ä»£ä¸¤ä¸ªå‡½æ•°ã€‚æ¥ä¸‹æ¥ï¼Œä½ å°†ç¼–å†™ä¸€ä¸ªæ³›å‹å‡½æ•°é’ˆå¯¹æ— è®ºå€¼æ˜¯ **integer** æˆ–è€… **float** ç±»å‹çš„ **map** ã€‚

## æ·»åŠ ä¸€ä¸ªæ³›å‹å‡½æ•°æ¥å¤„ç†å¤šç§ç±»å‹ã€‚

åœ¨è¿™ä¸ªéƒ¨åˆ†ï¼Œä½ å°†æ·»åŠ ä¸€ä¸ªæ³›å‹å‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°å¯ä»¥æ¥æ”¶åŒ…å« **integer** æˆ– **float** çš„ **map**ï¼Œä»è€Œæœ‰æ•ˆåœ°å°†åˆšåˆšç¼–å†™çš„ä¸¤ä¸ªå‡½æ•°æ›¿æ¢ä¸ºä¸€ä¸ªå‡½æ•°ã€‚

è¦æ”¯æŒä»»ä¸€ç±»å‹çš„å€¼ï¼Œè¿™ä¸ªå‡½æ•°éœ€è¦ä¸€ç§æ–¹æ³•æ¥å£°æ˜å®ƒæ”¯æŒçš„ç±»å‹ã€‚å¦ä¸€æ–¹é¢ï¼Œåœ¨è°ƒç”¨ä»£ç æ—¶ä¹Ÿéœ€è¦ä¸€ç§æ–¹æ³•æ¥æŒ‡å®šå®ƒæ˜¯ä½¿ç”¨ **integer** ç±»å‹çš„ **map** è¿˜æ˜¯ **float** ç±»å‹çš„ **map**ã€‚

ä¸ºäº†æ”¯æŒè¿™ä¸€ç‚¹ï¼Œä½ ç¼–å†™çš„å‡½æ•°åœ¨å…¶æ™®é€šå‡½æ•°å‚æ•°ä¹‹å¤–è¿˜å£°æ˜ç±»å‹å‚æ•°ï¼ˆ***type parameters***ï¼‰ã€‚è¿™äº›ç±»å‹å‚æ•°ï¼ˆ***type parameters***ï¼‰ä½¿è¿™ä¸ªå‡½æ•°æˆä¸ºæ³›å‹å‡½æ•°ï¼Œä½¿å…¶èƒ½å¤Ÿå¤„ç†ä¸åŒç±»å‹çš„å‚æ•°ã€‚ä½ å°†ä½¿ç”¨ç±»å‹å‚æ•°ï¼ˆ ***type arguments***ï¼‰å’Œæ™®é€šå‡½æ•°å‚æ•°æ¥è°ƒç”¨è¯¥å‡½æ•°ã€‚

æ¯ä¸ªç±»å‹å‚æ•°éƒ½æœ‰ä¸€ä¸ªç±»å‹çº¦æŸï¼ˆ***type constraint***ï¼‰ï¼Œå®ƒå……å½“ç±»å‹å‚æ•°çš„ä¸€ç§å…ƒç±»å‹ã€‚æ¯ä¸ªç±»å‹çº¦æŸï¼ˆ***type constraint***ï¼‰æŒ‡å®šè°ƒç”¨ä»£ç å¯ç”¨äºç›¸åº”ç±»å‹å‚æ•°çš„å…è®¸ç±»å‹å‚æ•°ï¼ˆ***type parameters***ï¼‰ã€‚

è™½ç„¶ç±»å‹å‚æ•°çš„çº¦æŸé€šå¸¸è¡¨ç¤ºä¸€ç»„ç±»å‹ï¼Œä½†åœ¨ç¼–è¯‘æ—¶ï¼Œç±»å‹å‚æ•°ä»£è¡¨å•ä¸€ç±»å‹â€”â€”è°ƒç”¨ä»£ç ä½œä¸ºç±»å‹å‚æ•°æä¾›çš„ç±»å‹ã€‚å¦‚æœç±»å‹å‚æ•°çš„çº¦æŸä¸å…è®¸ç±»å‹å‚æ•°çš„ç±»å‹ï¼Œåˆ™ä»£ç å°†æ— æ³•ç¼–è¯‘ã€‚

è¯·è®°ä½ï¼Œç±»å‹å‚æ•°å¿…é¡»æ”¯æŒæ³›å‹ä»£ç å¯¹å…¶æ‰§è¡Œçš„æ‰€æœ‰æ“ä½œã€‚ä¾‹å¦‚ï¼Œå¦‚æœä½ çš„å‡½æ•°ä»£ç å°è¯•å¯¹çº¦æŸåŒ…æ‹¬æ•°å­—ç±»å‹çš„ç±»å‹å‚æ•°æ‰§è¡Œ`string`æ“ä½œï¼ˆä¾‹å¦‚ç´¢å¼•ï¼‰ï¼Œåˆ™ä»£ç å°†æ— æ³•ç¼–è¯‘ã€‚

åœ¨å³å°†ç¼–å†™çš„ä»£ç ä¸­ï¼Œä½ å°†ä½¿ç”¨å…è®¸æ•´æ•°æˆ–æµ®ç‚¹ç±»å‹çš„ **constraint**ã€‚

### ç¼–å†™ä»£ç 

1. åœ¨æ‚¨ä¹‹å‰æ·»åŠ çš„ä¸¤ä¸ªå‡½æ•°ä¸‹æ–¹ï¼Œç²˜è´´ä»¥ä¸‹æ³›å‹å‡½æ•°ã€‚

   ```Go
   // SumIntsOrFloats sums the values of map m. It supports both int64 and float64
   // as types for map values.
   func SumIntsOrFloats[K comparable, V int64 | float64](m map[K]V) V {
       var s V
       for _, v := range m {
           s += v
       }
       return s
   }
   ```

   åœ¨ä»£ç ä¸­ï¼š

    - å£°æ˜ä¸€ä¸ª `SumIntsOrFloats` å‡½æ•°ï¼Œè¯¥å‡½æ•°å…·æœ‰ä¸¤ä¸ªç±»å‹å‚æ•°ï¼ˆtype parameters ï¼‰ï¼ˆæ–¹æ‹¬å·å†…çš„[]ï¼‰ï¼Œ**K** å’Œ **Vï¼Œ**ä»¥åŠä¸€ä¸ªä½¿ç”¨ç±»å‹å‚æ•° **m **çš„ **map[K]V** ç±»å‹çš„å‚æ•°ã€‚è¯¥å‡½æ•°è¿”å›ä¸€ä¸ªç±»å‹ä¸º **V** çš„å€¼ã€‚
    - ä¸º **K** ç±»å‹å‚æ•°æŒ‡å®š**comparable**çš„ç±»å‹çº¦æŸï¼ˆ**constraint**ï¼‰ã€‚ä¸“é—¨é’ˆå¯¹æ­¤ç±»æƒ…å†µï¼Œåœ¨ **Go** ä¸­é¢„å…ˆå£°æ˜äº†**comparable**çš„çº¦æŸã€‚å®ƒå…è®¸ä»»ä½•ç±»å‹çš„å€¼å¯ä»¥ç”¨ä½œæ¯”è¾ƒè¿ç®—ç¬¦ `==` å’Œ `!=` çš„æ“ä½œæ•°ã€‚**Go** è¦æ±‚**map**çš„**key**æ˜¯**comparable**çš„ã€‚å› æ­¤ï¼Œå¿…é¡»å°† **K** å£°æ˜ä¸º**comparable**ï¼Œè¿™æ ·æ‚¨å°±å¯ä»¥ä½¿ç”¨ **K** ä½œä¸º**map**å˜é‡ä¸­çš„**key**ã€‚å®ƒè¿˜ç¡®ä¿è°ƒç”¨æ–¹çš„ä»£ç ä¸­**map**çš„**key**é”®ä½¿ç”¨å…è®¸çš„ç±»å‹ï¼ˆ**comparable**ç±»å‹ï¼‰ã€‚
    - **V** ç±»å‹å‚æ•°æŒ‡å®šä¸€ä¸ªçº¦æŸæ˜¯ä¸¤ç§ç±»å‹çš„è”åˆï¼š`int64 ï½œfloat64`ã€‚ä½¿ç”¨ `|`ç¬¦å·æŒ‡å®šä¸¤ç§ç±»å‹çš„è”åˆï¼Œè¿™æ„å‘³ç€è¿™ä¸ªçº¦æŸï¼ˆ**constraint**ï¼‰å…è®¸å…¶ä¸­ä»»ä½•ä¸€ç§ç±»å‹ã€‚ç¼–è¯‘å™¨å°†å…è®¸ä»»ä¸€ç±»å‹ä½œä¸ºè°ƒç”¨ä»£ç ä¸­çš„å‚æ•°ã€‚
    - æŒ‡å®š **m** å‚æ•°çš„ç±»å‹ä¸º `map[K]V`ï¼Œå…¶ä¸­ **K** å’Œ **V** æ˜¯å·²ä¸ºç±»å‹å‚æ•°æŒ‡å®šçš„ç±»å‹

2. åœ¨ `main.go` ä¸­ï¼Œåœ¨æ‚¨å·²æœ‰çš„ä»£ç ä¸‹æ–¹ï¼Œç²˜è´´ä»¥ä¸‹ä»£ç ã€‚

   ```Go
   fmt.Printf("Generic Sums: %v and %v\n",
       SumIntsOrFloats[string, int64](ints),
       SumIntsOrFloats[string, float64](floats))
   ```

   åœ¨ä»£ç ä¸­ï¼š

    - è°ƒç”¨åˆšåˆšå£°æ˜çš„æ³›å‹å‡½æ•°ï¼Œä¼ é€’åˆ›å»ºçš„ä¸¤ä¸ª **map**ã€‚
    - æŒ‡å®šç±»å‹å‚æ•° - æ–¹æ‹¬å·ä¸­çš„ç±»å‹åç§° - ä»¥æ˜ç¡®åº”è¯¥æ›¿æ¢æ‚¨æ­£åœ¨è°ƒç”¨çš„å‡½æ•°ä¸­çš„ç±»å‹å‚æ•°çš„ç±»å‹ã€‚
    - æ‰“å°å‡½æ•°è¿”å›çš„æ€»å’Œã€‚

### è¿è¡Œä»£ç 

åœ¨ `main.go` çš„ç›®å½•ä¸­çš„å‘½ä»¤è¡Œä¸­ï¼Œè¿è¡Œä»£ç ã€‚

```Go
$ go run .
Non-Generic Sums: 46 and 62.97
Generic Sums: 46 and 62.97
```


ä¸ºäº†è¿è¡Œä»£ç ï¼Œåœ¨æ¯æ¬¡è°ƒç”¨ä¸­ï¼Œç¼–è¯‘å™¨ä¼šå°†ç±»å‹å‚æ•°æ›¿æ¢ä¸ºè¯¥è°ƒç”¨ä¸­æŒ‡å®šçš„å…·ä½“ç±»å‹ã€‚

åœ¨è°ƒç”¨ä½ ç¼–å†™çš„æ³›å‹å‡½æ•°æ—¶ï¼Œä½ æŒ‡å®šäº†ç±»å‹å‚æ•°ï¼Œå‘Šè¯‰ç¼–è¯‘å™¨ä½¿ç”¨ä»€ä¹ˆç±»å‹æ¥ä»£æ›¿å‡½æ•°çš„ç±»å‹å‚æ•°ã€‚æ­£å¦‚ä½ å°†åœ¨ä¸‹ä¸€èŠ‚ä¸­çœ‹åˆ°çš„ï¼Œåœ¨è®¸å¤šæƒ…å†µä¸‹ï¼Œæ‚¨å¯ä»¥çœç•¥è¿™äº›ç±»å‹å‚æ•°ï¼Œå› ä¸ºç¼–è¯‘å™¨å¯ä»¥æ¨æ–­å®ƒä»¬ã€‚

## è°ƒç”¨æ³›å‹å‡½æ•°æ—¶åˆ é™¤ç±»å‹å‚æ•°ï¼ˆ**type arguments**ï¼‰

åœ¨æœ¬èŠ‚ä¸­ï¼Œä½ å°†æ·»åŠ æ³›å‹å‡½æ•°è°ƒç”¨çš„ä¿®æ”¹ç‰ˆæœ¬ï¼Œè¿›è¡Œä¸€äº›å°æ”¹åŠ¨ä»¥ç®€åŒ–è°ƒç”¨ä»£ç ã€‚ä½ å°†åˆ é™¤åœ¨è¿™ç§æƒ…å†µä¸‹ä¸éœ€è¦çš„ç±»å‹å‚æ•°ã€‚

å½“ **Go** ç¼–è¯‘å™¨å¯ä»¥æ¨æ–­ä½ è¦ä½¿ç”¨çš„ç±»å‹æ—¶ï¼Œä½ å¯ä»¥åœ¨è°ƒç”¨ä»£ç ä¸­çœç•¥ç±»å‹å‚æ•°ã€‚ç¼–è¯‘å™¨ä»å‡½æ•°å‚æ•°çš„ç±»å‹æ¨æ–­ç±»å‹å‚æ•°ã€‚

è¯·æ³¨æ„ï¼Œè¿™å¹¶ä¸æ€»æ˜¯å¯èƒ½çš„ã€‚ä¾‹å¦‚ï¼Œå¦‚æœä½ éœ€è¦è°ƒç”¨æ²¡æœ‰å‚æ•°çš„æ³›å‹å‡½æ•°ï¼Œåˆ™éœ€è¦åœ¨å‡½æ•°è°ƒç”¨ä¸­åŒ…å«ç±»å‹å‚æ•°ã€‚

### ç¼–å†™ä»£ç 

- åœ¨ `main.go` ä¸­ï¼Œåœ¨å·²æœ‰çš„ä»£ç ä¸‹æ–¹ï¼Œç²˜è´´ä»¥ä¸‹ä»£ç ã€‚

  ```Go
  fmt.Printf("Generic Sums, type parameters inferred: %v and %v\n",
      SumIntsOrFloats(ints),
      SumIntsOrFloats(floats))
  ```

  åœ¨ä»£ç ä¸­ï¼š

- è°ƒç”¨æ³›å‹å‡½æ•°ï¼Œçœç•¥ç±»å‹å‚æ•°ã€‚

### è¿è¡Œä»£ç 

åœ¨ `main.go` çš„ç›®å½•ä¸­çš„å‘½ä»¤è¡Œä¸­ï¼Œè¿è¡Œä»£ç ã€‚

```Bash
$ go run .
Non-Generic Sums: 46 and 62.97
Generic Sums: 46 and 62.97
Generic Sums, type parameters inferred: 46 and 62.97

```

æ¥ä¸‹æ¥ï¼Œä½ å°†é€šè¿‡å°†æ•´æ•°å’Œæµ®ç‚¹æ•°çš„å¹¶é›†æ•è·åˆ°å¯ä»¥é‡ç”¨çš„ç±»å‹çº¦æŸä¸­æ¥è¿›ä¸€æ­¥ç®€åŒ–å‡½æ•°ï¼Œä¾‹å¦‚ä»å…¶ä»–ä»£ç ä¸­ã€‚

## å£°æ˜ç±»å‹çº¦æŸï¼ˆ**Declare a type constraint**ï¼‰

åœ¨æœ€åä¸€éƒ¨åˆ†ä¸­ï¼Œä½ å°†æŠŠä¹‹å‰å®šä¹‰çš„çº¦æŸï¼ˆ***constraint***ï¼‰ç§»åŠ¨åˆ°å®ƒè‡ªå·±çš„ `interface`ä¸­ï¼Œä»¥ä¾¿å¯ä»¥åœ¨å¤šä¸ªåœ°æ–¹é‡ç”¨å®ƒã€‚
å¯ä»¥åƒå£°æ˜`interface`ä¸€æ ·å£°æ˜ç±»å‹çº¦æŸ ï¼ˆ***type*** ***constraint***ï¼‰ã€‚çº¦æŸå…è®¸ä»»ä½•å®ç°è¿™ä¸ª`interface`çš„ç±»å‹ã€‚ä¾‹å¦‚ï¼Œå¦‚æœå£°æ˜äº†å…·æœ‰ä¸‰ä¸ªæ–¹æ³•çš„ç±»å‹çº¦æŸæ¥å£ï¼ˆ***type constraint interface***ï¼‰ï¼Œç„¶ååœ¨æ³›å‹å‡½æ•°ä¸­å°†å…¶ä¸ç±»å‹å‚æ•°ä¸€èµ·ä½¿ç”¨ï¼Œåˆ™ç”¨äºè°ƒç”¨è¯¥å‡½æ•°çš„ç±»å‹å‚æ•°å¿…é¡»å…·æœ‰æ‰€æœ‰è¿™äº›æ–¹æ³•ã€‚
æ­£å¦‚ä½ å°†åœ¨æœ¬èŠ‚ä¸­çœ‹åˆ°çš„é‚£æ ·ï¼Œçº¦æŸæ¥å£ä¹Ÿå¯ä»¥å¼•ç”¨ç‰¹å®šç±»çš„å‹ã€‚

### ç¼–å†™ä»£ç 

1. åœ¨ `main` ä¸Šæ–¹ï¼Œç´§è·Ÿ `import` è¯­å¥ä¹‹åï¼Œç²˜è´´ä»¥ä¸‹ä»£ç ä»¥å£°æ˜ç±»å‹çº¦æŸã€‚

   ```Go
   type Number interface {
       int64 | float64
   }
   ```

   åœ¨ä»£ç ä¸­ï¼š

- å£°æ˜ `Number` æ¥å£ç±»å‹ä»¥ç”¨ä½œç±»å‹çº¦æŸï¼ˆ***type*** ***constraint***ï¼‰ã€‚
- åœ¨ `interface`å†…å£°æ˜ `int64` å’Œ `float64` çš„è”åˆã€‚
  æœ¬è´¨ä¸Šï¼Œä½ å°†è”åˆä»å‡½æ•°å£°æ˜ç§»åŠ¨åˆ°æ–°çš„ç±»å‹çº¦æŸä¸­ã€‚è¿™æ ·ï¼Œå½“ä½ æƒ³å°†ç±»å‹å‚æ•°çº¦æŸä¸º `int64` æˆ– `float64` æ—¶ï¼Œä½ å¯ä»¥ä½¿ç”¨æ­¤ `Number` ç±»å‹çº¦æŸè€Œä¸æ˜¯å†™å‡º `int64 | float64`ã€‚ï¼ˆè¯‘è€…åŠ ï¼šæ„æ€æ˜¯å¦‚æœæœ‰åŒæ ·å‚æ•°çš„æ³›å‹å‡½æ•°å¯ä»¥ç›´æ¥é‡ç”¨è¿™ä¸ª `interface` ä¸ç”¨å†å†™ä¸€é`int64 | float64` ï¼‰ã€‚

2. åœ¨å·²æœ‰çš„å‡½æ•°ä¸‹æ–¹ï¼Œç²˜è´´ä»¥ä¸‹é€šç”¨ `SumNumbers` å‡½æ•°ã€‚

   ```Go
   // SumNumbers sums the values of map m. It supports both integers
   // and floats as map values.
   func SumNumbers[K comparable, V Number](m map[K]V) V {
       var s V
       for _, v := range m {
           s += v
       }
       return s
   }
   ```

   åœ¨ä»£ç ä¸­ï¼š

- å£°æ˜ä¸€ä¸ªä¸ä¹‹å‰å£°æ˜çš„æ³›å‹å‡½æ•°å…·æœ‰ç›¸åŒé€»è¾‘çš„æ³›å‹å‡½æ•°ï¼Œä½†ä½¿ç”¨æ–°çš„`inteface` è€Œä¸æ˜¯è”åˆä½œä¸ºç±»å‹çº¦æŸã€‚

3. åœ¨` main.go` ä¸­ï¼Œåœ¨å·²æœ‰çš„ä»£ç ä¸‹æ–¹ï¼Œç²˜è´´ä»¥ä¸‹ä»£ç ã€‚

   ```Go
   fmt.Printf("Generic Sums with Constraint: %v and %v\n",
       SumNumbers(ints),
       SumNumbers(floats))
   ```

   åœ¨ä»£ç ä¸­ï¼š

- ä½¿ç”¨æ¯ä¸ª**Map**è°ƒç”¨ `SumNumbers`ï¼Œæ‰“å°æ¯ä¸ª **Map** ä¸­ **Value** çš„æ€»å’Œã€‚
  ä¸ä¸Šä¸€èŠ‚ä¸€æ ·ï¼Œåœ¨è°ƒç”¨æ³›å‹å‡½æ•°æ—¶çœç•¥äº†ç±»å‹å‚æ•°ï¼ˆæ–¹æ‹¬å·ä¸­çš„ç±»å‹åç§°ï¼‰ã€‚ **Go** ç¼–è¯‘å™¨å¯ä»¥ä»å…¶ä»–å‚æ•°æ¨æ–­ç±»å‹å‚æ•°ã€‚



### è¿è¡Œä»£ç 

åœ¨ `main.go` çš„ç›®å½•ä¸­çš„å‘½ä»¤è¡Œä¸­ï¼Œè¿è¡Œä»£ç ã€‚

```Bash
$ go run .
Non-Generic Sums: 46 and 62.97
Generic Sums: 46 and 62.97
Generic Sums, type parameters inferred: 46 and 62.97
Generic Sums with Constraint: 46 and 62.97
```


## ç»“è®º

åšå¾—å¾ˆå¥½ï¼ä½ åˆšåˆšå‘è‡ªå·±ä»‹ç»äº† **Go** ä¸­çš„æ³›å‹ã€‚

å»ºè®®çš„ä¸‹ä¸€ä¸ªä¸»é¢˜ï¼š

- [**Go Tour**](https://tour.golang.org/welcome/1)æ˜¯å¯¹ **Go** åŸºç¡€çŸ¥è¯†çš„é€æ­¥ä»‹ç»ã€‚
- ä½ å°†åœ¨[**Effective Go**](https://go.dev/doc/effective_go)å’Œ[**How to write Go code**](https://go.dev/doc/code)ä¸­æ‰¾åˆ°æœ‰ç”¨çš„ **Go** æœ€ä½³å®è·µã€‚

## å®Œæ•´çš„ä»£ç 

ä½ å¯ä»¥åœ¨ [Go playground](https://go.dev/play/p/apNmfVwogK0?v=gotip)ä¸Šè¿è¡Œè¿™ä¸ªç¨‹åºã€‚åªéœ€å•å‡»â€œ**Run**â€æŒ‰é’®ã€‚

```Go
package main

import "fmt"

type Number interface {
    int64 | float64
}

func main() {
    // Initialize a map for the integer values
    ints := map[string]int64{
        "first": 34,
        "second": 12,
    }

    // Initialize a map for the float values
    floats := map[string]float64{
        "first": 35.98,
        "second": 26.99,
    }

    fmt.Printf("Non-Generic Sums: %v and %v\n",
        SumInts(ints),
        SumFloats(floats))

    fmt.Printf("Generic Sums: %v and %v\n",
        SumIntsOrFloats[string, int64](ints),
        SumIntsOrFloats[string, float64](floats))

    fmt.Printf("Generic Sums, type parameters inferred: %v and %v\n",
        SumIntsOrFloats(ints),
        SumIntsOrFloats(floats))

    fmt.Printf("Generic Sums with Constraint: %v and %v\n",
        SumNumbers(ints),
        SumNumbers(floats))
}

// SumInts adds together the values of m.
func SumInts(m map[string]int64) int64 {
    var s int64
    for _, v := range m {
        s += v
    }
    return s
}

// SumFloats adds together the values of m.
func SumFloats(m map[string]float64) float64 {
    var s float64
    for _, v := range m {
        s += v
    }
    return s
}

// SumIntsOrFloats sums the values of map m. It supports both floats and integers
// as map values.
func SumIntsOrFloats[K comparable, V int64 | float64](m map[K]V) V {
    var s V
    for _, v := range m {
        s += v
    }
    return s
}

// SumNumbers sums the values of map m. Its supports both integers
// and floats as map values.
func SumNumbers[K comparable, V Number](m map[K]V) V {
    var s V
    for _, v := range m {
        s += v
    }
    return s
}
```

